
This application is designed to streamline the process of managing and recording transactions between companies and farmers. It provides an interface for handling company configurations, product management, transaction logging, premium charges, farmer records, and synchronization between offline and online states. Below is a comprehensive explanation of how to set up and use the system.

---

## üõ†Ô∏è Application Initialization and User Login

Once the server is successfully set up, the application becomes accessible. To begin using it, the user must first log in. However, before a user can log in, they must be created and assigned to a company. User creation and company assignment are both done through the Django admin interface. A user without a company cannot log in or access any features of the application.

---

## üè¢ Company Setup and Configuration

The first step in configuring the system is setting up a company. Every user is mapped to a company, and each company plays a central role in how the application behaves. In the Django admin panel, a company can be configured in terms of its transaction capabilities.

A company can be:

- **Sell-enabled**, which means it is only allowed to perform sales transactions.
- **Buy-enabled**, which means it can only buy products.
- **Both**, in which case the company can perform both buying and selling operations.

This setting determines which options are available in the application‚Äôs interface for logging transactions.

Additionally, companies can have **payout premiums** configured. A payout premium enables the "Payments" functionality within the application‚Äôs home screen. This allows for paying farmers from application. These premiums are optional but become essential for enabling payment functionality in the app.

---

## üë§ User Creation and Assignment

Users are created using Django admin. After creating a user, it is important to assign them to a specific company, as this determines what data and features the user will have access to within the application. Once a user is assigned to a company, they can log in to the app and begin performing transactions, managing farmers, and interacting with the system.

---

## üì¶ Product Management and Premiums

In order to conduct transactions, there must be products associated with the company. Products are also created through the Django admin panel. Once created, products must be mapped to a company to indicate which products are relevant for which business entity.

Beyond basic product setup, the system supports the configuration of **premiums**, which are additional charges applied to transactions. These can be based on various types:

- Per kilogram (e.g., extra cost added per kg of product transacted)
- Per transaction (e.g., a flat fee added regardless of quantity)

Premiums can be designated to apply specifically to either buy or sell transactions. If premiums need to be product-specific, they can be added under the **Company Product** mapping. This ensures precise control over how premiums are charged based on both the company and the product involved.

---

## üìÑ Dynamic Forms and Field Configuration

To allow flexibility in data collection during various operations, the application includes a dynamic form system. These forms can be configured via the Django admin to capture additional information during:

- Transactions
- Payments
- Farmer registration
- Products

Each form is defined in the Form model, and its fields can be customized using the **Form Field Configs**. This configuration lets administrators control field behavior on the frontend, such as:

- Making a field required
- Showing or hiding fields based on certain conditions
- Adjusting how fields behave in different transaction types

This allows the application to adapt to evolving data needs without requiring hardcoded changes to the UI.

---

## üë©‚Äçüåæ Farmer Management

Farmers are core participants in the transaction process and can be added directly through the mobile application. The application provides an interface under the **Farmers tab**, where farmers can be created, viewed, and managed.

Farmers can be:

- Searched by name
- Located using a unique card ID (if assigned)
- Sorted and exported to CSV for reporting or record-keeping

Each farmer can also be assigned a **farmer card**, which helps in identifying and retrieving their profile quickly during transactions. This card is assigned through the farmer‚Äôs detail section within the app.

---

## üí∞ Transactions Interface

All transactions involving buying or selling are recorded and visible under the **Transactions tab** in the application. Users can view the transaction history, but it is important to note that the mobile app only shows **transactions that were synced since the last successful synchronization**. This helps reduce app load time and ensures better offline usability.

The full set of transaction records is available in the **Connect Web Application**, which is designed for more comprehensive data review and administration.

Users can also:

- Filter transactions based on various parameters
- Export the data to CSV
- Use this data for auditing or reporting purposes

---

## üîÑ Synchronization and Offline Mode

The application is designed to function both **online and offline**, which is critical in rural or low-connectivity environments.

When working offline, any transaction that is performed is stored locally on the device. Once an internet connection becomes available, the system automatically attempts to sync these records with the database.

There are two key options provided for manual synchronization:

1. **Sync**: This option appears in the top-right corner of the app and can be used to manually push pending data to the server if automatic syncing fails.
2. **Hot Sync**: This is a more advanced sync feature used to reset listing and reference data in the mobile app from the database. It **does not delete any database data**. It is especially useful if there are inconsistencies or issues in the mobile data and a fresh pull from the server is required.

---

## üë§ Profile and User Preferences

Under the **Profile tab**, users can update their own personal information. In addition to personal details, users can  customize how the app behaves and displays data.

Settings available include:

- Changing the application language
- Adjusting number formats (e.g., decimal separators, digit grouping)
- Enabling or disabling transaction announcements (e.g., audio or on-screen prompts)

These customizations help improve usability for users operating in different regions or with different preferences.


## How to Create and Configure Entities via Django Admin

The steps to create a company, add products, assign company members, configure premiums, and perform other related additions through the Django admin interface are outlined below.




## Accessing the Admin Panel

- **URL**: `{root_url}/connect/admin/`

<img src="/images/connect/admin/login.png" alt="Login screen" />

- **Credentials**: Found in `connect-infra/env/.django.env`  
  The admin user is created during instance setup by the credentials used in 
  the env

---

## Create a Company

Each company plays a central role in how the application behaves. In the Django admin panel, a company can be configured in terms of its transaction capabilities.

1. In the sidebar, under **Supply Chains**, click **Companies**.
2. On the Companies list page, click **‚ÄúAdd Company‚Äù** (top-right).
3. Fill in all required fields
4. Click **Save** to create the company.

<img src="/images/connect/admin/add_company.png" alt="Add company" />

- **Buy Enable**: Enable buying for the company (default: enabled)
- **Sell Enable**: Allow company to sell (requires buyer setup)
- **Only Connect**: Skips syncing (used for Connect-specific companies). Trace is an easy-to-use blockchain-based platform that allows agri-food businesses to make their supply chain transparent and trace their products from farm-to-fork. Connect is a Standalone Mobile App. The data from the connect can be synced with trace application if this option is disabled and this option is enabled for connect specific companies only.
- **Allow Multiple Login**: Enables multiple device logins for the user
- **Make Farmer Private**: This enables date of birth validation for the farmer passbook. The farmer passbook is a standalone Open API section where farmer details can be accessed using farmer card IDs. If the company to which the farmer belongs has **Make Farmer Private** enabled, users must provide the farmer‚Äôs date of birth to view the details.

For sell enabled companies buyers should be mapped.
- **Is Default**: Makes the buyer the default buyer of the company. While selling this buyer will be selected as default.

<img src="/images/connect/admin/add_company_buyer.png"/>

---

## Create a User

- **User Creation in Connect Application**: A user can be created in the Connect application and later mapped to a company. This user can then be assigned various roles and permissions to perform different operations within the system.

1. Navigate to **Accounts ‚Üí Base User**
2. Click **‚ÄúAdd Base User‚Äù**.
3. Fill in the fields and save.

<img src="/images/connect/admin/add_base_user.png" alt="Add User" />

4. Now, fill other fields and save.

<img src="/images/connect/admin/user_creation.png" alt="Add User" />


Note: Set the username and email address as the email.

---

## Map User to Company

After creating a user, it is important to assign them to a specific company, as this determines what data and features the user will have access to within the application. Once a user is assigned to a company, they can log in to the app and begin performing transactions, managing farmers, and interacting with the system.
1. Navigate to **Supply-Chains ‚Üí Company Members**
2. Click **‚ÄúAdd Company Member‚Äù**.
3. Select the user, company and user type accordingly
4. Save the mapping.

<img src="/images/connect/admin/add_company_member.png" alt="Add Member" />

---

## Add a Product

- **Product Creation in Connect Application**: A product can be created in the Connect application and later mapped to a company. This product can them be used to perform different operations within the system.

1. Navigate to **Catalogs ‚Üí Product**
2. Click **‚ÄúAdd Product‚Äù**.

<img src="/images/connect/admin/add_product.png" alt="Add Product" />

3. Fill in the detials and save

---

## Add a Product to Company

In order to conduct transactions, there must be products associated with the company. Once created, products must be mapped to a company to indicate which products are relevant for which business entity.

1. Navigate to **Supply-Chains ‚Üí Companies**
2. Select the company which you want to edit.
3. Click on Add company product and select the product

<img src="/images/connect/admin/add_company_product.png" alt="Add Company Product" />

4. Save changes.

- In order to hide product Tick "Is Company Product Active" to make the product invisible in the App.

<img src="/images/connect/admin/product_active.png"/>


---

## Add a Premium

Beyond basic product setup, the system supports the configuration of premiums, which are additional charges applied to transactions. Premiums can be designated to apply specifically to either buy or sell transactions.

1. Navigate to **Catalogs ‚Üí Premiums**
2. Click **‚ÄúAdd Premium‚Äù**.

<img src="/images/connect/admin/add_premium.png"/>

3. Fill in the fields and save.

- **Premium Type**
  - `Per Transaction`: The premium is applied once for each transaction, regardless of the quantity involved.
  - `Per KG`: The premium is calculated based on the weight of the product in kilograms.
  - `Per Unit Currency`: The premium is a percentage or fixed amount relative to the total value of the transaction (based on the currency).
  - `Per Farmer`: The premium is applied once for each farmer involved, regardless of how much they produce.
- **Applicable Activity**
  - `Buy`: Applies only when buying
  - `Sell`: Applies only when selling
- **Premium Category**
  - `Transaction Premium`: Related to transactions
  - `Payout Premium`: For payments only, which enable **Pay** option in the application
- **Calculation Type**
  - `Normal`: Used for product premiums, entered manually
  - `Manual`: Entered manually
  - `Options (Dropdown)`: Uses predefined options
  - `Ranges`: Uses value ranges

---

## Add product premium

If premiums need to be product-specific, they can be added under the Company Product mapping. This ensures precise control over how premiums are charged based on both the company and the product involved.

1. Navigate to **Supply-Chains ‚Üí Companies**
2. Add or edit the relevant **Company Product**.

<img src="/images/connect/admin/add_company_product.png"/>

3. Add or map **Premiums** (e.g., *Kualitas Premium* mapped with *Black Pepper*).
4. Save changes.

---

## Add Custom Forms

To allow flexibility in data collection during various operations, the application includes a dynamic form system. These forms can be configured via the Django admin to capture additional information. Each form is defined in the Form model, and its fields can be customized using the Form Field Configs. This configuration lets administrators control field behavior on the frontend, such a making a field required, hiding fields etc. This allows the application to adapt to evolving data needs without requiring hardcoded changes to the UI.

1. Navigate to **Forms ‚Üí Forms**
2. Click **‚ÄúAdd Form‚Äù**.
3. Select **Form Type**:
   - `Transactions`: For transaction creation
   - `Farmer`: For farmer registration
   - `Payment`: Shown during payment
   - `Product`: Shown when specific products are used (must be added in Company Product)

<img src="/images/connect/admin/add_form.png"/>

4. Add **Form Fields** (types, dropdowns, etc.)

<img src="/images/connect/admin/add_form_field.png"/>

5. Optionally configure **Form Field Configs** to control frontend visibility and behavior.

<img src="/images/connect/admin/add_form_field_config.png"/>

6. Save the form.

--- 